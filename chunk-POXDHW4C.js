import"./chunk-PVDG46DZ.js";import{a as ht,b as bt,c as vt}from"./chunk-BB2N4PX2.js";import{a as et,b as it}from"./chunk-AMDGY35O.js";import{a as q,b as G,e as j,f as Q,g as E,i as H,j as W,n as J,o as K,p as X,q as Y,s as Z,v as $}from"./chunk-56PBU4MC.js";import{a as Ot,b as kt,c as Rt}from"./chunk-YPONCBFO.js";import{a as yt}from"./chunk-CUQTRSG4.js";import{a as St,b as gt,c as Pt}from"./chunk-JKHKVBHF.js";import{x as nt}from"./chunk-MJI6BM56.js";import{a as Et,b as Mt,c as It,d as wt,e as Dt,f as Bt}from"./chunk-CL7B6CHS.js";import{a as Tt}from"./chunk-2VPSIEJZ.js";import{e as T,g as U}from"./chunk-ZVAGCAJB.js";import"./chunk-Y3LMP6WH.js";import{C as ct,D as ut,E as ft,F as _t,a as L,p as tt,q as at,r as ot,t as rt,w as lt,x as dt}from"./chunk-NTJYNLFM.js";import"./chunk-UH5WVR5Y.js";import{a as xt,b as Ct}from"./chunk-VXIZCXGT.js";import{Bb as P,Db as u,Ia as i,J as I,Lb as k,Mb as R,Ob as M,Qb as s,R as w,Rb as f,Sb as y,Wa as B,Wb as F,Xb as N,Yb as V,Zb as a,_b as o,ab as O,ea as m,ja as v,jb as h,jc as A,ka as S,kb as x,lb as C,mc as z,pa as D,pb as c,qb as r,rb as p,sb as b,wd as pt,xd as st,yd as mt,zb as g}from"./chunk-C2BZCJ46.js";import"./chunk-Q7L6LLAK.js";var Ft=e=>[e],Nt=(e,d)=>[e,d],Vt=(e,d,t)=>[e,d,t];function At(e,d){if(e&1){let t=g();r(0,"div",2)(1,"button",12),P("deleted",function(){v(t);let l=u(2);return S(l.onDeleted())}),s(2),a(3,"translate"),p()()}if(e&2){let t=u(2);i(),c("appPostDelete",t.dataSource.data().id),i(),y(" ",o(3,2,"uni.delete")," ")}}function zt(e,d){if(e&1){let t=g();r(0,"button",13),a(1,"translate"),a(2,"translate"),P("click",function(){v(t);let l=u(2);return l.form.controls.title.setValue(""),S(l.form.controls.body.markAsDirty())}),r(3,"mat-icon"),s(4,"close"),p()()}e&2&&(c("matTooltip",o(1,2,"uni.clear")),h("aria-label",o(2,4,"uni.clear")))}function Lt(e,d){if(e&1){let t=g();r(0,"button",13),a(1,"translate"),a(2,"translate"),P("click",function(){v(t);let l=u(2);return l.form.controls.body.setValue(""),S(l.form.controls.body.markAsDirty())}),r(3,"mat-icon"),s(4,"close"),p()()}e&2&&(c("matTooltip",o(1,2,"uni.clear")),h("aria-label",o(2,4,"uni.clear")))}function Ut(e,d){if(e&1){let t=g();x(0,At,4,4,"div",2),r(1,"mat-card")(2,"mat-card-header")(3,"mat-card-subtitle"),s(4),p(),r(5,"mat-card-title"),s(6),p()(),r(7,"mat-card-content",3)(8,"form",4),P("ngSubmit",function(){v(t);let l=u();return S(l.onSubmit())})("reset",function(l){v(t);let _=u();return S(_.onReset(l))}),r(9,"mat-form-field",5)(10,"mat-label"),s(11),a(12,"translate"),p(),b(13,"input",6),x(14,zt,5,6,"button",7),p(),r(15,"mat-form-field",5)(16,"mat-label"),s(17),a(18,"translate"),p(),b(19,"textarea",8,0),a(21,"translate"),x(22,Lt,5,6,"button",7),p(),r(23,"div",9)(24,"button",10),s(25),a(26,"translate"),p(),r(27,"button",11),s(28),a(29,"translate"),p()()()()()}if(e&2){let t=u();C(t.dataSource.state()==="data"?0:-1),i(3),M("blur-sm",t.dataSource.state()!=="data"),i(),f("#"+t.dataSource.data().id),i(),M("blur-sm",t.dataSource.state()!=="data"),i(),f(t.dataSource.data().title),i(2),c("formGroup",t.form),i(3),f(o(12,17,"form.post.title.label")),i(3),C(t.form.controls.title.value?14:-1),i(3),f(o(18,19,"form.post.body.label")),i(2),c("placeholder",o(21,21,"form.post.body.placeholder")),i(3),C(t.form.controls.body.value?22:-1),i(2),c("disabled",t.form.pristine),i(),y(" ",o(26,23,"uni.reset")," "),i(2),c("disabled",t.form.pristine||t.form.invalid),i(),y(" ",o(29,25,"uni.submit")," ")}}function qt(e,d){if(e&1&&(r(0,"mat-card")(1,"mat-card-content",14),b(2,"mat-icon",15),a(3,"translate"),r(4,"div"),s(5),p()()()),e&2){let t=u();i(2),h("aria-label",o(3,2,"uni.aria-label.error-icon")),i(3),f(t.dataSource.error())}}function Gt(e,d){e&1&&(r(0,"mat-card")(1,"mat-card-content",14),b(2,"mat-icon",16),a(3,"translate"),r(4,"div"),s(5),a(6,"translate"),p()()()),e&2&&(i(2),h("aria-label",o(3,2,"uni.aria-label.warning-icon")),i(3),f(o(6,4,"error.post-was-not-found")))}function jt(e,d){if(e&1&&(b(0,"mat-icon",19),a(1,"translate"),r(2,"a",18),a(3,"localize"),s(4),p(),b(5,"mat-icon",19),a(6,"translate"),r(7,"a",18),a(8,"localize"),a(9,"localize"),s(10),a(11,"translate"),p()),e&2){let t=u(2);h("aria-label",o(1,6,"uni.aria-label.arrow-icon")),i(2),c("routerLink",N(18,Nt,o(3,8,"/"+t.ROUTE_DEFINITION.APP.POSTS),t.dataSource.data().id)),i(2),f(t.dataSource.data().id),i(),h("aria-label",o(6,10,"uni.aria-label.arrow-icon")),i(2),c("routerLink",V(21,Vt,o(8,12,"/"+t.ROUTE_DEFINITION.APP.POSTS),t.dataSource.data().id,o(9,14,t.ROUTE_DEFINITION.POSTS.EDIT))),i(3),y(" ",o(11,16,"breadcrumbs.posts.edit"))}}function Qt(e,d){if(e&1&&(r(0,"div",17)(1,"a",18),a(2,"localize"),s(3),a(4,"translate"),p(),x(5,jt,12,25),p()),e&2){let t=u();i(),c("routerLink",F(7,Ft,o(2,3,"/"+t.ROUTE_DEFINITION.APP.POSTS))),i(2),f(o(4,5,"breadcrumbs.app.posts")),i(2),C(t.dataSource.state()==="data"?5:-1)}}var we=(()=>{let d=class d{constructor(){this.breadcrumbsPortalService=m(Tt),this.cdr=m(z),this.confirm=m(Pt),this.fb=m(Y),this.route=m(rt),this.apiService=m(St),this.translate=m(pt),this.lr=m(ct),this.snackBar=m(nt),this.router=m(lt),this.portalContent=A.required(T),this.destroyRef=m(D),this.dataSource=new Ot(kt),this.ROUTE_DEFINITION=_t,this.form=this.fb.nonNullable.group({title:["",[E.required,E.min(3)]],body:["",[E.required,E.min(3)]]})}canDeactivate(){return this.form.pristine||this.confirm.openCustomConfirmDialog(gt.UnsavedWork)}ngOnDestroy(){this.portalContent()?.detach()}ngOnInit(){setTimeout(()=>{this.breadcrumbsPortalService.setPortal(this.portalContent()),this.cdr.markForCheck()}),this.route.paramMap.pipe(Rt(),w(n=>this.apiService.detail(n)),L(this.destroyRef)).subscribe({next:n=>{this.dataSource.setData(n),this.form.patchValue(n)},error:()=>{let n=this.translate.instant("error.unexpected-exception");this.dataSource.setError(n)}})}onSubmit(){this.apiService.patch(this.dataSource.data().id,this.form.value).pipe(I()).subscribe({next:n=>{this.dataSource.setData(n),this.form.reset(n),this.snackBar.open(this.translate.instant("response.update.success"),this.translate.instant("uni.close"))},error:()=>{this.snackBar.open(this.translate.instant("response.update.failed"),this.translate.instant("uni.close"))}})}onReset(n){n.preventDefault(),this.form.reset(this.dataSource.data())}onDeleted(){let n=this.lr.translateRoute("/");this.router.navigate([n])}};d.\u0275fac=function(l){return new(l||d)},d.\u0275cmp=B({type:d,selectors:[["app-post-edit"]],viewQuery:function(l,_){l&1&&k(_.portalContent,T,5),l&2&&R()},decls:4,vars:3,consts:[["autosize","cdkTextareaAutosize"],["class","container flex items-center gap-1 py-4",4,"cdkPortal"],[1,"flex","items-end","justify-end","gap-2"],[1,"flex","flex-col","gap-2","mt-2","text-center"],[3,"ngSubmit","reset","formGroup"],[1,"w-full"],["matInput","","type","text","formControlName","title"],["matSuffix","","mat-icon-button","",3,"matTooltip"],["matInput","","cdkTextareaAutosize","","formControlName","body",3,"placeholder"],[1,"flex","justify-center","gap-2"],["mat-button","","color","primary","type","reset",3,"disabled"],["mat-flat-button","","color","primary","type","submit",3,"disabled"],["mat-button","","color","accent",3,"deleted","appPostDelete"],["matSuffix","","mat-icon-button","",3,"click","matTooltip"],[1,"flex","flex-col","gap-2","text-center"],["aria-hidden","false","fontIcon","error"],["aria-hidden","false","fontIcon","warning"],[1,"container","flex","items-center","gap-1","py-4"],["mat-button","","color","primary",3,"routerLink"],["aria-hidden","false","fontIcon","chevron_right"]],template:function(l,_){l&1&&(x(0,Ut,30,27),x(1,qt,6,4,"mat-card"),x(2,Gt,7,6,"mat-card"),O(3,Qt,6,9,"div",1)),l&2&&(C(_.dataSource.state()==="loading"||_.dataSource.state()==="data"?0:-1),i(),C(_.dataSource.state()==="error"?1:-1),i(),C(_.dataSource.state()==="empty"?2:-1))},dependencies:[ft,ot,at,tt,Bt,Et,It,Dt,wt,Mt,$,j,q,G,Ct,xt,it,et,vt,bt,ht,U,T,Z,J,Q,H,W,K,X,dt,mt,yt,ut,st],styles:["[_nghost-%COMP%]{width:100%;margin-right:auto;margin-left:auto;padding-right:1rem;padding-left:1rem}@media (min-width: 640px){[_nghost-%COMP%]{max-width:640px}}@media (min-width: 768px){[_nghost-%COMP%]{max-width:768px}}@media (min-width: 1024px){[_nghost-%COMP%]{max-width:1024px}}@media (min-width: 1280px){[_nghost-%COMP%]{max-width:1280px}}@media (min-width: 1536px){[_nghost-%COMP%]{max-width:1536px}}[_nghost-%COMP%]{display:block}[_nghost-%COMP%] > [_ngcontent-%COMP%]:not([hidden]) ~ [_ngcontent-%COMP%]:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.5rem * var(--tw-space-y-reverse))}[_nghost-%COMP%]{padding-top:1rem;padding-bottom:1rem}"],changeDetection:0});let e=d;return e})();export{we as PostEditComponent};
